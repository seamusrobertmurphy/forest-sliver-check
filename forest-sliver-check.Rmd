---
title: "Forest Sliver Check"
author: "SCS-SMurphy"
date: "2024-03-19"
output: 
  github_document:
    toc: TRUE
    toc_depth: 5
    df_print: tibble
    keep_html: TRUE

always_allow_html: true
---

```{r setup, include=FALSE, message = FALSE, warning=FALSE, error=FALSE}
library(readxl)
library(magrittr)
library(janitor)
library(ggplot2)
library(dplyr)
library(RColorBrewer)
library(psych)
library(tmap)
library(useful)
library(caret)
library(tibble)
library(DescTools)
library(animation)
library(ModelMetrics)
library(knitr)
library(kableExtra)
library(rmarkdown)
library(dataMaid)
library(animation)
library(sf)
library(htmltools)
library(gtsummary)
library(data.table)
library(htmltools)
library(latex2exp)
options(htmltools.dir.version = FALSE, htmltools.preserve.raw = FALSE)
knitr::opts_chunk$set(
  echo = TRUE, message = FALSE, warning = FALSE,
  error = FALSE, comment = NA, tidy.opts = list(width.cutoff = 60), tidy = "styler"
)
```

```{r}
polygon = read_sf("~/git_repos/forest-sliver-check/data/LWS_LUCC_Reference_Region_2009_2015_2018.shp")
multipolygon = st_cast(polygon, "MULTIPOLYGON")
```

## Task

***Prototype Tool for Checking Minimum Size of Forest Polygons in Submitted Baseline & Project Area Shapefiles***

```{r}
multipolygon$area = st_area(multipolygon)
slivers = multipolygon %>%
  dplyr::filter(as.numeric(area) < 5000)

ggplot(slivers) +
  geom_sf(aes(color = 'red')) + 
  theme_bw() +
  theme(
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    legend.position = "none"
  )
```

```{r}
st_write(slivers, "slivers.shp")
```

```{r}
tmap_mode("view")
tm_shape(st_geometry(slivers)) + tm_polygons()
```
